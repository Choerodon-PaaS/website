var $results,INDEX_DATA={};function initLunr(){$.getJSON("/lunr.json").done(function(e){INDEX_DATA=e}).fail(function(e,t,n){var s=t+", "+n;console.error("Error getting Hugo index flie:",s)})}function initUI(){$results=$("#content-post"),$("#content").on("click","#search",function(){$("#content-post").html(""),$("#content-post #blog-list").remove(),$("#content-post #paginator").remove();var e=$("#search-input").val(),t=search(e,500);void 0===t||0===t.length?($("#content-post .noresult").remove(),$results.append("<h1 class='noresult'>很抱歉，我们没有找到与“"+e+"“相关的博客</h1>")):renderResults(t)})}function escapeReg(e){return String(e).replace(/([\*\.\?\+\$\^\[\]\(\)\{\}\|\/\\])/g,"\\$1")}function search(e,t){if(null!=e&&""!==e.trim()){var n=[],s=-1;for(var a in INDEX_DATA)-1!==(s=INDEX_DATA[a].body.toLowerCase().indexOf(e.toLowerCase()))&&n.push({url:INDEX_DATA[a].url,title:INDEX_DATA[a].title,date:INDEX_DATA[a].date,author:INDEX_DATA[a].author,description:INDEX_DATA[a].description,tags:INDEX_DATA[a].tags,categories:INDEX_DATA[a].categories,img:INDEX_DATA[a].img,body:INDEX_DATA[a].body.substr(Math.max(0,s-50),t).replace(new RegExp("("+escapeReg(e)+")","gi"),'<span style="background:#ff0;">$1</span>')});return n}}function renderResults(e){if(e.length){$("#content-post .noresult").remove();var c="/zh/";-1!=window.location.href.indexOf("/en/")&&(c="/en/"),e.slice(0,10).forEach(function(e){var t="分类",n="作者";"/en/"==c&&(t="Tags",n="Author");var s=$('<div class="row blog-list" id="blog-list"></div>'),a=$('<div class="blog-list-content" style="width:100%">'),i=$('<a href="'+c+e.url+'"class="right-title">'+e.title+"</a>"),o=$('<div class="right-info"><span class="right-user">'+n+"：<span>"+e.author+'</span></span><span class="right-categories">'+t+': <a href="'+c+"/categories/"+e.categories[0].toLowerCase()+'">'+e.categories[0]+'</a></span><span class="right-time"><i class="iconfont">&#xe8cf;</i>'+e.date+"</span></div>"),r=$('<div class="right-text">'+e.body+"</div>"),l=$('<ul class="right-tags">');for(index=0;index<e.tags.length;index++)l.append('<li class="tag"><a class="tag-text" href="'+c+"/tags/"+e.tags[index].toLowerCase()+'"><i class="iconfont">&#xe844;</i> '+e.tags[index]+"</a></li>");l.append("</ul");a.append(i),a.append(o),a.append(r),a.append(l),a.append("</div>"),s.append(a),s.append("</div>"),$results.append(s)})}}$(document).ready(function(){initLunr(),initUI()});